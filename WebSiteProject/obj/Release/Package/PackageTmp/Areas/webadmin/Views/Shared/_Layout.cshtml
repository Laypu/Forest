<!DOCTYPE html>
@{
    if (Request.IsAuthenticated)
    {
        var user = Request.GetOwinContext().Authentication.User;
        var role = user.FindFirst(System.Security.Claims.ClaimTypes.Role);
        if (role == null)
        {

        }
        else
        {
            var index = Request.Form["menuindex"] == null ? "" : Request.Form["menuindex"].ToString();
            //ViewBag.urlcontroller = this.ViewContext.RouteData.Values["controller"].ToString().ToLower();
            //ViewBag.urlaction = this.ViewContext.RouteData.Values["action"].ToString().ToLower();
            if (index != "-1")
            {
                if (index == "" && HttpContext.Current.Session["Menuindex"] != null)
                {
                    index = HttpContext.Current.Session["Menuindex"].ToString();
                }
                else
                {
                    HttpContext.Current.Session["Menuindex"] = index;
                }
            }
            else
            {
                index = ""; HttpContext.Current.Session["Menuindex"] = "";
            }

            ViewBag.UserName = Request.GetOwinContext().Authentication.User.Identity.Name;
            if (role != null) { ViewBag.Role = role.Value; }
            var langclaim = user.FindFirst("Language");
            var groupid = user.FindFirst("GroupID");
            var menutype = Session["menutype"];
            if (menutype == null) { menutype = "1"; }
            if (langclaim == null)
            {
                Response.Redirect(Url.Action("Login", "Account", new { area = "webadmin" }));
            }
            else
            {
                var MasterPageManager = new Services.Manager.MasterPageManager(WebSiteProject.Code.Common.connectionStr, langclaim.Value,Common.GetLangDict());
                ViewBag.langid = langclaim.Value;
                var menu = MasterPageManager.GetAdminMenuString(langclaim.Value, menutype.ToString(), groupid.Value, role.Value, index);
                ViewBag.leftmenu = menu;
                ViewBag.menustr = MasterPageManager.GetLinkString(langclaim.Value, menutype.ToString(), groupid.Value, role.Value, index);
            }
        }
    }
    else
    {
        if (Session["FromAdmin"] == null)
        {
            Response.Redirect(Url.Action("Login", "Account", new { area = "webadmin" }));
            //Response.Redirect(Url.Action("Index", "Home", new { area = "webadmin" }));
        }
        else
        {
            Response.Redirect(Url.Action("Login", "Account", new { area = "webadmin" }));
        }
    }

    ViewBag.PageTitle = WebSiteProject.Code.CacheMapping.PageTitle;
}
<html lang="zh">

<head>
    <meta charset="utf-8" />
    <title>@ViewBag.PageTitle</title>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link href="@Url.Content("~/Content/admincss/font-awesome.min.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/admincss/simple-line-icons.min.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/admincss/bootstrap.min.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/admincss/components.min.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/admincss/layout.min.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/admincss/darkblue.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/admincss/style.css")" rel="stylesheet" />
    <link rel="shortcut icon" href="@Url.Content("~/img/favicon.ico")" />
    <script src="@Url.Content("~/Scripts/jquery-3.3.1.min.js")"></script>
    <script src="@Url.Content("~/Scripts/jquery-migrate-3.0.0.min.js")"></script>
    <script src="@Url.Content("~/Scripts/bootstrap.js")"></script>
    <script src="@Url.Content("~/Scripts/app.min.js")"></script>
    <script src="@Url.Content("~/Scripts/layout.min.js")"></script>

    @RenderSection("scripts", required: false)
    <script type="text/javascript">
        var gname = '@ViewBag.Role';

    </script>
</head>
<body class="page-header-fixed page-sidebar-closed-hide-logo page-content-white">

    <!--top menu start-->
    <div class="page-header navbar navbar-fixed-top">
        <div class="page-header-inner ">

            <!--logo start-->
            <div class="page-logo">
                <a href="@Url.Action("Index","Home")" class="logo-default">Forest</a>
                <div class="menu-toggler sidebar-toggler">
                    <span></span>
                </div>
            </div>
            <!--logo end-->
            <!--mobile menu start-->
            <a href="javascript:;" class="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse">
                <span></span>
            </a>
            <!--mobile menu end-->
            <!--top menu start-->
            <div class="collapse navbar-collapse top-navbar">
                @{
                    var AuthList = (List<SQLModel.Models.AdminFunctionAuth>)ViewBag.AuthList;
                    <ul class="nav navbar-nav">
                        @if (ViewBag.Role == "admin")
                        {
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="內容總管"><i class="icon-directions"></i> <span class="top_menu_title">內容總管</span> <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a path="@Url.Action("Index", "Home",new { menutype = "1" })" class="topmenu" title="主要選單">主要選單</a></li>
                                    <li><a path="@Url.Action("Index", "Home",new { menutype = "2" })" class="topmenu" title="上方選單">上方選單</a></li>
                                    <li><a path="@Url.Action("Index", "Home",new { menutype = "3" })" class="topmenu" title="下方選單">下方選單</a></li>
                                </ul>
                            </li>
                        }
                        else
                        {
                            if (AuthList != null && AuthList.Any(v => v.GID == 1))
                            {
                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="內容總管"><i class="icon-directions"></i> <span class="top_menu_title">內容總管</span> <b class="caret"></b></a>
                                    <ul class="dropdown-menu">
                                        @if (AuthList.Any(v => v.ItemID == 1))
                                        {
                                            <li><a path="@Url.Action("Index", "Home",new { menutype = "1" })" class="topmenu" title="主要選單">主要選單</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 2))
                                        {
                                            <li><a path="@Url.Action("Index", "Home",new { menutype = "2" })" class="topmenu" title="上方選單">上方選單</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 3))
                                        {
                                            <li><a path="@Url.Action("Index", "Home",new { menutype = "3" })" class="topmenu" title="下方選單">下方選單</a></li>}
                                    </ul>
                                </li>
                            }
                        }
                        @if (ViewBag.Role == "admin")
                        {
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="系統管理"><i class="icon-settings"></i> <span class="top_menu_title">系統管理</span> <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a path="@Url.Action("SiteConfig", "Config")" class="topmenu" title="管理介面設定">管理介面設定</a></li>
                                    <li><a path="@Url.Action("PasswordEdit", "Config")" class="topmenu" title="密碼設定">密碼設定</a></li>
                                    <li><a path="@Url.Action("UserList", "Config")" class="topmenu" title="權限管理">權限管理</a></li>
                                    <li><a path="@Url.Action("SiteFlow", "Config")" class="topmenu" title="流量分析">流量分析</a></li>
                                    <li><a path="@Url.Action("Verify", "Config")" class="topmenu" title="審核管理">審核管理</a></li>
                                </ul>
                            </li>
                        }
                        else
                        {
                            if (AuthList != null && AuthList.Any(v => v.GID == 2))
                            {
                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="系統管理"><i class="icon-directions"></i> <span class="top_menu_title">系統管理</span> <b class="caret"></b></a>
                                    <ul class="dropdown-menu">
                                        @if (AuthList.Any(v => v.ItemID == 6))
                                        {
                                            <li><a path="@Url.Action("SiteConfig", "Config")" class="topmenu" title="管理介面設定">管理介面設定</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 7))
                                        {
                                            <li><a path="@Url.Action("PasswordEdit", "Config")" class="topmenu" title="密碼設定">密碼設定</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 8))
                                        {
                                            <li><a path="@Url.Action("UserList", "Config")" class="topmenu" title="權限管理">權限管理</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 10))
                                        {
                                            <li><a path="@Url.Action("SiteFlow", "Config")" class="topmenu" title="流量分析">流量分析</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 27))
                                        {
                                            <li><a path="@Url.Action("Verify", "Config")" class="topmenu" title="審核管理">審核管理</a></li>}
                                    </ul>
                                </li>
                            }
                        }
                        @if (ViewBag.Role == "admin")
                        {
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="網站選單"><i class="icon-layers"></i> <span class="top_menu_title">網站選單</span> <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a path="@Url.Action("MainMenu", "Menu",new { menutype = "1" })" class="topmenu" title="主要選單">主要選單</a></li>
                                    <li><a path="@Url.Action("MainMenu", "Menu",new { menutype = "2" })" class="topmenu" title="上方選單">上方選單</a></li>
                                    <li><a path="@Url.Action("MainMenu", "Menu",new { menutype = "3" })" class="topmenu" title="下方選單">下方選單</a></li>
                                </ul>
                            </li>
                        }
                        else
                        {
                            if (AuthList != null && AuthList.Any(v => v.GID == 3))
                            {
                                <li class="dropdown">
                                    <a path="#" class="dropdown-toggle" data-toggle="dropdown" title="網站選單"><i class="icon-directions"></i> <span class="top_menu_title">網站選單</span> <b class="caret"></b></a>
                                    <ul class="dropdown-menu">
                                        @if (AuthList.Any(v => v.ItemID == 11))
                                        {
                                            <li><a path="@Url.Action("MainMenu", "Menu",new { menutype = "1" })" class="topmenu" title="主要選單">主要選單</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 12))
                                        {
                                            <li><a path="@Url.Action("MainMenu", "Menu",new { menutype = "2" })" class="topmenu" title="上方選單">上方選單</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 13))
                                        {
                                            <li><a path="@Url.Action("MainMenu", "Menu",new { menutype = "3" })" class="topmenu" title="下方選單">下方選單</a></li>}

                                    </ul>
                                </li>
                            }
                        }
                        @if (ViewBag.Role == "admin")
                        {
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="版面設定"><i class="icon-puzzle"></i> <span class="top_menu_title">版面設定</span> <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a path="@Url.Action("SiteLayout", "Site",new { stype = "P" })" class="topmenu" title="網站版面資訊設定">網站版面資訊設定</a></li>
                                    <li><a path="@Url.Action("PageNewsEdit", "Site",new { stype="P" })" class="topmenu" title="入口首頁配置">入口首頁配置</a></li>
                                    <li><a path="@Url.Action("SiteLangText", "Site")" class="topmenu" title="語系通用文字設定">語系通用文字設定</a></li>
                                </ul>
                            </li>
                        }
                        else
                        {
                            if (AuthList != null && AuthList.Any(v => v.GID == 4))
                            {
                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="版面設定"><i class="icon-directions"></i> <span class="top_menu_title">版面設定</span> <b class="caret"></b></a>
                                    <ul class="dropdown-menu">
                                        @if (AuthList.Any(v => v.ItemID == 16))
                                        {
                                            <li><a path="@Url.Action("SiteLayout", "Site",new { stype = "P" })" class="topmenu" title="網站版面資訊設定">網站版面資訊設定</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 17))
                                        {
                                            <li><a path="@Url.Action("SiteLangText", "Site")" class="topmenu" title="語系通用文字設定">語系通用文字設定</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 18))
                                        {
                                            <li><a path="@Url.Action("PageNewsEdit", "Site",new { stype="P" })" class="topmenu" title="入口首頁配置">入口首頁配置</a></li>}
                                    </ul>
                                </li>
                            }
                        }
                        @if (ViewBag.Role == "admin")
                        {
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="模組元件"><i class="icon-social-dropbox"></i> <span class="top_menu_title">模組元件</span> <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a path="@Url.Action("Index", "SEO")" class="topmenu" title="SEO優化設定">SEO優化設定</a></li>
                                    <li><a path="@Url.Action("Index", "Model")" class="topmenu" title="選單程式模組管理">選單程式模組管理</a></li>
                                    <li><a path="@Url.Action("Index", "AD",new { type = "main" ,stype="P" })" class="topmenu" title="輪播廣告管理(主廣告)">輪播廣告管理(主廣告)</a></li>
                                    <li><a path="@Url.Action("Index", "AD",new { type = "main" ,stype="M" })" class="topmenu" title="輪播廣告管理(手機版-主廣告)">輪播廣告管理(手機版-主廣告)</a></li>
                                    <li><a path="@Url.Action("IndexSetting", "Model")" class="topmenu" title="全文檢索管理">全文檢索管理</a></li>
                                </ul>
                            </li>
                        }
                        else
                        {
                            if (AuthList != null && AuthList.Any(v => v.GID == 5))
                            {
                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="模組元件"><i class="icon-directions"></i> <span class="top_menu_title">模組元件</span> <b class="caret"></b></a>
                                    <ul class="dropdown-menu">
                                        @if (AuthList.Any(v => v.ItemID == 21))
                                        {
                                            <li><a path="@Url.Action("Index", "SEO")" class="topmenu" title="SEO優化設定">SEO優化設定</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 22))
                                        {
                                            <li><a path="@Url.Action("Index", "Model")" class="topmenu" title="選單程式模組管理">選單程式模組管理</a></li>}

                                        @if (AuthList.Any(v => v.ItemID == 24))
                                        {
                                            <li><a path="@Url.Action("Index", "AD",new { type = "main" ,stype="P" })" class="topmenu" title="輪播廣告管理(主廣告)">輪播廣告管理(主廣告)</a></li>}
                                        @if (AuthList.Any(v => v.ItemID == 25))
                                        {
                                            <li><a path="@Url.Action("Index", "AD",new { type = "main" ,stype="M" })" class="topmenu" title="輪播廣告管理(手機版-主廣告)">輪播廣告管理(手機版-主廣告)</a></li>} 
                                        @if (AuthList.Any(v => v.ItemID == 26))
                                        {
                                            <li><a path="@Url.Action("IndexSetting", "Model")" class="topmenu" title="全文檢索管理">全文檢索管理</a></li>}
                                        </ul>
                                </li>
                            }
                        }

                    </ul>
                }
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="語系切換"><i class="fa fa-language"></i> <span class="top_menu_title">語系切換</span> <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            @Html.Raw(WebSiteProject.Code.CacheMapping.LangOption)
                        </ul>
                    </li>
                </ul>
                <div class="top-menu hidden-sm hidden-xs">
                    <ul class="nav navbar-nav pull-right">
                        <li class="dropdown dropdown-quick-sidebar-toggler">
                            <a href="@Url.Action("Index", "Home", new { area = "" })?langid=@ViewBag.langid" target="_blank" title="瀏覽前台">
                                <i class="fa fa-television"></i>
                                <span class="title">瀏覽前台</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Logout", "Account")" title="登出">
                                <i class="fa fa-sign-out"></i> 登出
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!--top menu end-->
        </div>
    </div>
    <!--top menu end-->

    <div class="page-container">

        <!--left menu start-->
        <div class="page-sidebar-wrapper">
            <div class="page-sidebar navbar-collapse collapse">
                <ul class="page-sidebar-menu  page-header-fixed " data-keep-expanded="false" data-auto-scroll="true" data-slide-speed="200" id="menulist">

                    @*<li class="nav-item start active open">*@
                    <li class="nav-item letter active">
                        @*<a href="@Url.Action("Index_ADMain","Home")" class="nav-link nav-toggle" title="Home">*@
                        <a href="@Url.Action("Index","Home")" class="nav-link nav-toggle" title="Home">
                            <i class="icon-home"></i>
                            <span class="title">Home</span>
                        </a>
                    </li>
                    @Html.Raw(ViewBag.leftmenu)
                    <li class="nav-item hidden-lg hidden-md ">
                        <a href="@Url.Content("~/Content/files/操作手冊.pdf")" target="_blank" title="操作手冊">
                            <i class="fa fa-book"></i>
                            <span class="title">操作手冊</span>
                        </a>
                    </li>

                    <li class="nav-item hidden-lg hidden-md">
                        <a href="@Url.Action("Index","Home")" title="瀏覽前台">
                            <i class="fa fa-television"></i>
                            <span class="title">瀏覽前台</span>
                        </a>
                    </li>

                    <li class="nav-item hidden-lg hidden-md">
                        <a href="javascript:;" title="登出">
                            <i class="icon-logout"></i>
                            <span class="title">登出</span>
                        </a>
                    </li>

                </ul>
            </div>
        </div>
        <!--left menu end-->
        <!--content start-->
        <div class="page-content-wrapper">
            <div class="page-content">
                @RenderBody()
            </div>
        </div>
        <!--content end-->

    </div>

    <!--footer start-->
    <div class="page-footer">
        <div class="page-footer-inner">Powered by Laypu Technology</div>
        <div class="scroll-to-top">
            <i class="icon-arrow-up"></i>
        </div>
    </div>
    <!--footer end-->
    <script src="@Url.Content("~/Scripts/custom.js")"></script>
</body>
</html>
<script type="text/javascript">

    var Index_data;

    $(function () {

           $("#menulist").delegate((".title"), "click", function () {
               var index = $(this).attr('index');
               $.post('@Url.Action("GotoMenu","Account")', { id: index }, function (data) {
                   if (data[0] == "3") {
                       window.open(data[1]);
                   } else if (data[0] == "2")  {
                       var obj = {};
                       obj.menuindex = index;
                        obj[data[2]] = data[3];
                        CreatePost(data[1], obj);

                        console.log(data[3]);
                        Index_data = data[3];
                   };
                });
           });

           $(".topmenu").click(function () {
               var path=$(this).attr('path')
               CreatePost(path, { menuindex:"-1"});
           });

           $("#menulist").delegate((".topmenu"), "click", function () {
               var index = $(this).attr('index');
               $.post('@Url.Action("GotoMenu","Account")', { id: index }, function (data) {

                   if (data[0] == "3") {
                       window.open(data[1]);
                   } else if (data[0] == "2")  {
                       var obj = {};
                       obj.menuindex = index;
                        obj[data[2]] = data[3];
                        CreatePost( data[1], obj);
                   }
                });
           });
           $(".langchange").click(function () {
               var lang = $(this).attr('langid');
               $.post('@Url.Action("SetLang","Account")', { lang: lang }, function (data) {
                   document.location.href = '@Url.Action("Index","Home")';
               });
           });

           //載入首頁Load Select
           Index_Select_Load();

           //取得Index_Id
           //F_ResetOrderIndex();

           //F_Index_Select_Load('24');

        
        
    });


     //載入Load Select
        function Index_Select_Load() {
            var Url = $("#Index_Partial_Selectis[data-index='']").val();
            console.log( "Index_Select_Load=" + Url);
            $("#Partial_Index").load(Url)

            $("#Partial_Index").append(
                `<div class="portlet light bordered">
                    <!--set item start-->
                    <div class="table-toolbar">
                        <div class="col-md-6 col-sm-12 col-xs-12">
                            <p class="class_title">管理項目</p>
                            <div class="display_inline">
                                <select id="Index_Partial_Select" class="form-control checkitem" onchange="window.location.href=this.value">
                                    <option data-index="0" value="">請選擇</option>
                                    <option data-index="1" value="@Url.Action("Index_ADMain","Home", new { home_type = "main", home_stype = "P"})">首頁輪播牆一(電腦版)</option>
                                    <option data-index="1" value="@Url.Action("Index_ADMain","Home", new { home_type = "main", home_stype = "M" })">首頁輪播牆一(手機版)</option>

                                    <option data-index="2" value="@Url.Action("Five_Thingstodo", "F_Thingtodo", new { F_MenuType = 0 })">五大旅遊資訊設定</option>
                                    <option data-index="3" value="@Url.Action("Index_FreeZone","Home", new { id=1 })">自由編輯區一</option>
                                    <option data-index="4" value="@Url.Action("Index_ADMain2", "Home", new { home_type = "main", home_stype = "P"})">首頁輪播牆二(電腦版)</option>
                                    <option data-index="4" value="@Url.Action("Index_ADMain2", "Home", new { home_type = "main", home_stype = "M" })">首頁輪播牆二(手機版)</option>

                                    <option data-index="5" value="@Url.Action("Index_FreeZone","Home",new { id=2 })">自由編輯區二</option>
                                    <option data-index="6" value="@Url.Action("Index_Img", "Home", new { })">圖片區一</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>`
               
            );

            var str = $(".title_04").text();

            $("#Index_Partial_Select").children(`option:contains(${str})`).attr("selected", "selected").siblings().removeAttr("selected");
            
       };

       //載入Load Select
       function F_Index_Select_Load(indexid) {
           console.log("indexid="  +indexid);
           switch (indexid){
               case '179': //Destinations
                   Load_Destinations();
                   break;
                case '24':  //Things to do
                   Load_ThingsToDo();
                   break;
                case '176': //Recommended trips
                   Load_RecommendedTrips();
                   break;
                case '45':  //Facts
                   Load_Facts();
                    break;
                case '57':  //Video
                   Load_Video();
                    break;
           };
       };


        //case 179: Destinations
       function Load_Destinations() {
           console.log("Load_Destinations");
            $("#Partial_Index_MenuLink").append(
                    `<div class="portlet light bordered">
                        <!--set item start-->
                        <div class="table-toolbar">
                            <div class="col-md-6 col-sm-12 col-xs-12">
                                <p class="class_title">管理項目</p>
                                <div class="display_inline">
                                    <select id="Index_Partial_Select" class="form-control checkitem" onchange="window.location.href=this.value">
                                        <option data-index="0" value="#">請選擇</option>
                                        <option data-index="1" value="@Url.Action("MenuLinkEdit", "Menu", new { menuid=179 ,MenuType=179 })">連結路徑</option>
                                        <option data-index="2" value="@Url.Action("Index", "AD", new { type = "main" , stype = "P", site_id = 3, MenuType=179})">輪播牆設定(電腦版)</option>
                                        <option data-index="2" value="@Url.Action("Index", "AD", new { type = "main" , stype = "M", site_id = 3, MenuType=179})">輪播牆設定(手機版)</option>
                                        <option data-index="3" value="@Url.Action("MainTitleAndContent", "Destination_Index")">目的地主版設定(標題&文字)</option>
                                        <option data-index="4" value="@Url.Action("Destination","Destination_Index", new { F_MenuType = 179,MenuType=179})">目的地設定</option>
                                        <option data-index="5" value="@Url.Action("Index","Destination_MapLegend", new { F_MenuType = 179,MenuType=179})">MapLegend設定</option>
                                        <option data-index="6" value="@Url.Action("Five_ThingsToDo_HashTag", "F_Thingtodo", new { mainid = '9' })">旅遊資訊標籤設定</option>
                                        <option data-index="7" value="@Url.Action("ModelItem", "Message",new { mainid = '9' })">旅遊資訊文章設定</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>`
                );

            //顯示該連結
            ShowLink();
           };

       //case 176: Recommended trips
       function Load_RecommendedTrips() {
           $("#Partial_Index_MenuLink").append(
                `<div class="portlet light bordered">
                    <!--set item start-->
                    <div class="table-toolbar">
                        <div class="col-md-6 col-sm-12 col-xs-12">
                            <p class="class_title">管理項目</p>
                            <div class="display_inline">
                                <select id="Index_Partial_Select" class="form-control checkitem" onchange="window.location.href=this.value">
                                    <option data-index="0" value="#">請選擇</option>
                                   <option data-index="1" value="@Url.Action("MenuLinkEdit", "Menu", new { menuid=176 ,MenuType=176 })">連結路徑</option>
                                   <option data-index="2" value="@Url.Action("Index", "AD", new { type = "main" , stype = "P", site_id = 11, MenuType=176})">輪播牆設定(電腦版)</option>
                                   <option data-index="3" value="@Url.Action("RecommendedtripsIndex", "Recommendedtrips")">推薦行程主版設定(標題&文字)</option>
                                   <option data-index="4" value="@Url.Action("Recommendedtrips_item", "Recommendedtrips")">推薦行程設定</option>
                                     <option data-index="4" value="@Url.Action("RecommendedTrip_Travel_Item", "Recommendedtrips")">推薦行程旅遊行程</option>
                                    <option data-index="2" value="#">Load_RecommendedTrips</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>`
            );

           //顯示該連結
           ShowLink();
      };


        //case 24: Things to do
       function Load_ThingsToDo() {
           $("#Partial_Index_MenuLink").append(
                `<div class="portlet light bordered">
                    <!--set item start-->
                    <div class="table-toolbar">
                        <div class="col-md-6 col-sm-12 col-xs-12">
                            <p class="class_title">管理項目</p>
                            <div class="display_inline">
                                <select id="Index_Partial_Select" class="form-control checkitem" onchange="window.location.href=this.value">
                                    <option data-index="0" value="#">請選擇</option>
                                    <option data-index="1" value="@Url.Action("MenuLinkEdit", "Menu", new { menuid=24 })">連結路徑</option>
                                    <option data-index="2" value="@Url.Action("Index", "AD", new { type = "main" , stype = "P", site_id = 4, MenuType=24})">輪播牆設定(電腦版)</option>
                                    <option data-index="2" value="@Url.Action("Index", "AD", new { type = "main" , stype = "M", site_id = 4, MenuType=24})">輪播牆設定(手機版)</option>
                                    <option data-index="3" value="@Url.Action("MainTitleAndContent", "F_Thingtodo")">旅遊資訊主版設定(標題&文字)</option>
                                    <option data-index="4" value="@Url.Action("Five_Thingstodo","F_Thingtodo", new { F_MenuType = 24, MenuType=24 })">五大旅遊資訊設定</option>
                                    <option data-index="6" value="@Url.Action("Five_ThingsToDo_HashTag", "F_Thingtodo", new { mainid = '9' })">旅遊資訊標籤設定</option>
                                    <option data-index="5" value="@Url.Action("ModelItem", "Message",new { mainid = '9' })">旅遊資訊文章設定</option>
                                 </select>
                            </div>
                        </div>
                    </div>
                </div>`
            );

           //顯示該連結
           ShowLink();

           console.log("Load_ThingsToDo");
      };

     //case 45:  Facts
      function Load_Facts() {
          $("#Partial_Index_MenuLink").append(
                `<div class="portlet light bordered">
                    <!--set item start-->
                    <div class="table-toolbar">
                        <div class="col-md-6 col-sm-12 col-xs-12">
                            <p class="class_title">管理項目</p>
                            <div class="display_inline">
                                <select id="Index_Partial_Select" class="form-control checkitem" onchange="window.location.href=this.value">
                                    <option data-index="0" value="#">請選擇</option>
                                    <option data-index="1" value="#">連結路徑</option>
                                    <option data-index="2" value="#">Load_Facts</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>`
            );

          //顯示該連結
          ShowLink();
      };

    //case 57:  Video
      function Load_Video() {
          $("#Partial_Index_MenuLink").append(
                `<div class="portlet light bordered">
                    <!--set item start-->
                    <div class="table-toolbar">
                        <div class="col-md-6 col-sm-12 col-xs-12">
                            <p class="class_title">管理項目</p>
                            <div class="display_inline">
                                <select id="Index_Partial_Select" class="form-control checkitem" onchange="window.location.href=this.value">
                                    <option data-index="0" value="#">請選擇</option>
                                    <option data-index="1" value="#">連結路徑</option>
                                    <option data-index="2" value="@Url.Action("ModelItem", "Video", new { mainid = 5 })">Load_Video</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>`
            );

          //顯示該連結
          ShowLink();
      };


      //重設定OrderIndex_________start
      var F_time;
      function F_ResetOrderIndex() {
          var title01 = $(".title_01").text();
          console.log(title01);
          var i = 1;
          if (title01 != null) {
              var title01_true = $(`#menulist li a[title='${title01}']`).children("span").attr("index");
              console.log(title01_true);
              clearInterval(F_time); //清除Interval

              //載入其他頁面
              F_Index_Select_Load(title01_true);
          };
      };
      F_time = setInterval(F_ResetOrderIndex, 50); //每0.05秒重新設定Index
      //重設定OrderIndex_________end


      //顯示連結
      function ShowLink() {
          $("#F_TTD_Index").removeClass("hidden");
          //$("#Index_Partial_Select").change(function () {
          //    var option_val = $("#Index_Partial_Select option:selected").attr("data-index");
          //    console.log("................................" + option_val);
          //    if (option_val == 1) {
          //        $("#F_TTD_Index").removeClass("hidden");
          //    } else {
          //        $("#F_TTD_Index").removeClass("hidden").addClass("hidden");
          //    };
          //});
      };




</script>